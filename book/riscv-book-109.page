<div id="pf6d" class="pf w0 h0" data-page-no="6d"><div class="pc pc6d w0 h0"><img class="bi xf yfe1 w2 hba" alt="" src="bg6d.png"/><div class="t m0 xf h8 y10b ff3 fs4 fc0 sc0 ls0 ws0">7.5.<span class="_ _1f"> </span>V<span class="_ _12"></span>ALUE<span class="_ _2"> </span>AND<span class="_ _2"> </span>REFERENCE<span class="_ _2"> </span>P<span class="_ _9"></span>ARAMETERS</div><div class="t m0 x114 h9 yfe2 ff22 fs11 fc0 sc0 ls0 ws0">1<span class="_ _2a"> </span><span class="ff5 fs4">#<span class="_ _4"> </span>sum10(10,20,30,40,50,60,70,80,90,100);</span></div><div class="t m0 x114 h9 yfe3 ff22 fs11 fc0 sc0 ls0 ws0">2<span class="_ _2a"> </span><span class="ff5 fs4">main:</span></div><div class="t m0 x114 h9 yfe4 ff22 fs11 fc0 sc0 ls0 ws0">3<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a0,<span class="_ _4"> </span>10<span class="_ _87"> </span>#<span class="_ _4"> </span>1st<span class="_ _4"> </span>parameter</span></div><div class="t m0 x114 h9 yfe5 ff22 fs11 fc0 sc0 ls0 ws0">4<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a1,<span class="_ _4"> </span>20<span class="_ _87"> </span>#<span class="_ _4"> </span>2nd<span class="_ _4"> </span>parameter</span></div><div class="t m0 x114 h9 yfe6 ff22 fs11 fc0 sc0 ls0 ws0">5<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a2,<span class="_ _4"> </span>30<span class="_ _87"> </span>#<span class="_ _4"> </span>3rd<span class="_ _4"> </span>parameter</span></div><div class="t m0 x114 h9 yfe7 ff22 fs11 fc0 sc0 ls0 ws0">6<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a3,<span class="_ _4"> </span>40<span class="_ _87"> </span>#<span class="_ _4"> </span>4th<span class="_ _4"> </span>parameter</span></div><div class="t m0 x114 h9 yfe8 ff22 fs11 fc0 sc0 ls0 ws0">7<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a4,<span class="_ _4"> </span>50<span class="_ _87"> </span>#<span class="_ _4"> </span>5th<span class="_ _4"> </span>parameter</span></div><div class="t m0 x114 h9 yfe9 ff22 fs11 fc0 sc0 ls0 ws0">8<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a5,<span class="_ _4"> </span>60<span class="_ _87"> </span>#<span class="_ _4"> </span>6th<span class="_ _4"> </span>parameter</span></div><div class="t m0 x114 h9 yfea ff22 fs11 fc0 sc0 ls0 ws0">9<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a6,<span class="_ _4"> </span>70<span class="_ _87"> </span>#<span class="_ _4"> </span>7th<span class="_ _4"> </span>parameter</span></div><div class="t m0 x126 h9 yfeb ff22 fs11 fc0 sc0 ls0 ws0">10<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>a7,<span class="_ _4"> </span>80<span class="_ _87"> </span>#<span class="_ _4"> </span>8th<span class="_ _4"> </span>parameter</span></div><div class="t m0 x126 h9 yfec ff22 fs11 fc0 sc0 ls0 ws0">11<span class="_ _7a"> </span><span class="ff5 fs4">addi<span class="_ _4"> </span>sp,<span class="_ _4"> </span>sp,<span class="_ _4"> </span>-8<span class="_ _7a"> </span>#<span class="_ _18"> </span>allocate<span class="_ _4"> </span>stack<span class="_ _18"> </span>space<span class="_ _4"> </span>for<span class="_ _4"> </span>two<span class="_ _4"> </span>parameters</span></div><div class="t m0 x126 h9 yfed ff22 fs11 fc0 sc0 ls0 ws0">12<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>t1,<span class="_ _4"> </span>100<span class="_ _bc"> </span>#<span class="_ _4"> </span>push<span class="_ _18"> </span>the<span class="_ _4"> </span>10th<span class="_ _4"> </span>parameter</span></div><div class="t m0 x126 h9 yfee ff22 fs11 fc0 sc0 ls0 ws0">13<span class="_ _7a"> </span><span class="ff5 fs4">sw<span class="_ _4"> </span>t1,<span class="_ _4"> </span>4(sp)</span></div><div class="t m0 x126 h9 yfef ff22 fs11 fc0 sc0 ls0 ws0">14<span class="_ _7a"> </span><span class="ff5 fs4">li<span class="_ _4"> </span>t1,<span class="_ _4"> </span>90<span class="_ _87"> </span>#<span class="_ _4"> </span>push<span class="_ _4"> </span>the<span class="_ _18"> </span>9th<span class="_ _4"> </span>parameter</span></div><div class="t m0 x126 h9 yff0 ff22 fs11 fc0 sc0 ls0 ws0">15<span class="_ _7a"> </span><span class="ff5 fs4">sw<span class="_ _4"> </span>t1,<span class="_ _4"> </span>0(sp)</span></div><div class="t m0 x126 h9 yff1 ff22 fs11 fc0 sc0 ls0 ws0">16<span class="_ _7a"> </span><span class="ff5 fs4">jal<span class="_ _4"> </span>sum10<span class="_ _87"> </span>#<span class="_ _4"> </span>invoke<span class="_ _4"> </span>sum10</span></div><div class="t m0 x126 h9 yff2 ff22 fs11 fc0 sc0 ls0 ws0">17<span class="_ _7a"> </span><span class="ff5 fs4">addi<span class="_ _4"> </span>sp,<span class="_ _4"> </span>sp,<span class="_ _4"> </span>8<span class="_ _3f"> </span>#<span class="_ _4"> </span>deallocate<span class="_ _18"> </span>the<span class="_ _4"> </span>parameters<span class="_ _4"> </span>from<span class="_ _4"> </span>stack</span></div><div class="t m0 x126 h9 yff3 ff22 fs11 fc0 sc0 ls0 ws0">18<span class="_ _7a"> </span><span class="ff5 fs4">ret</span></div><div class="t m0 xc h8 yff4 ff3 fs4 fc0 sc0 ls0 ws0">The routine that w<span class="_ _27"></span>as inv<span class="_ _27"></span>oked<span class="_ _a"> </span>(<span class="ff5">sum10<span class="_ _38"> </span></span>in this example) m<span class="_ _27"></span>ust retrieve the parameters<span class="_ _a"> </span>from the registers</div><div class="t m0 xf h8 yff5 ff3 fs4 fc0 sc0 ls0 ws0">and the<span class="_ _38"> </span>stack accordingly to<span class="_ _6"> </span>the ABI.<span class="_ _38"> </span>The<span class="_ _6"> </span>following code<span class="_ _6"> </span>shows a p<span class="_ _5"></span>ossible implementation for the <span class="ff5">sum10</span></div><div class="t m0 xf h8 yff6 ff3 fs4 fc0 sc0 ls0 ws0">routine and<span class="_ _38"> </span>illustrates<span class="_ _6"> </span>this pro<span class="_ _5"></span>cess.<span class="_ _7"> </span>It loads<span class="_ _6"> </span>the v<span class="_ _27"></span>alues<span class="_ _6"> </span>of the<span class="_ _6"> </span>9</div><div class="t m0 x147 hc yff7 ffa fs7 fc0 sc0 ls0 ws0">th</div><div class="t m0 x58 h8 yff6 ff3 fs4 fc0 sc0 ls0 ws0">and the<span class="_ _38"> </span>10</div><div class="t m0 x128 hc yff7 ffa fs7 fc0 sc0 ls0 ws0">th</div><div class="t m0 x148 h8 yff6 ff3 fs4 fc0 sc0 ls0 ws0">parameters from<span class="_ _38"> </span>the<span class="_ _6"> </span>stack</div><div class="t m0 xf h8 yff8 ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _1"></span>to<span class="_ _2"> </span>registers<span class="_ _2"> </span><span class="ff5">t1<span class="_ _2"> </span></span>and<span class="_ _2"> </span><span class="ff5">t2</span>.<span class="_ _7"> </span>Notice<span class="_ _2"> </span>that,<span class="_ _2"> </span>ev<span class="_ _1"></span>en<span class="_ _2"> </span>though<span class="_ _2"> </span>it<span class="_ _2"> </span>loads<span class="_ _2"> </span>these<span class="_ _2"> </span>v<span class="_ _27"></span>alues<span class="_ _2"> </span>from<span class="_ _2"> </span>the<span class="_ _2"> </span>program<span class="_ _2"> </span>stac<span class="_ _1"></span>k,<span class="_ _2"> </span>it<span class="_ _2"> </span>do<span class="_ _5"></span>es</div><div class="t m0 xf h8 yff9 ff3 fs4 fc0 sc0 ls0 ws0">not p<span class="_ _5"></span>op<span class="_ _6"> </span>(deallo<span class="_ _5"></span>cate) the<span class="_ _6"> </span>v<span class="_ _27"></span>alues from<span class="_ _6"> </span>the program<span class="_ _6"> </span>stack - this<span class="_ _38"> </span>cleaning<span class="_ _6"> </span>pro<span class="_ _5"></span>cess must b<span class="_ _5"></span>e<span class="_ _38"> </span>p<span class="_ _5"></span>erformed<span class="_ _6"> </span>by the</div><div class="t m0 xf h8 yffa ff3 fs4 fc0 sc0 ls0 ws0">caller<span class="_ _2"> </span>routine,<span class="_ _2"> </span><span class="ff8">i.e.</span>,<span class="_ _6"> </span>the<span class="_ _2"> </span>routine<span class="_ _2"> </span>that<span class="_ _2"> </span>inv<span class="_ _27"></span>oked<span class="_ _6"> </span>the<span class="_ _2"> </span><span class="ff5">sum10<span class="_ _2"> </span></span>routine.</div><div class="t m0 x114 h9 yffb ff22 fs11 fc0 sc0 ls0 ws0">1<span class="_ _2a"> </span><span class="ff5 fs4">sum10:</span></div><div class="t m0 x114 h9 yffc ff22 fs11 fc0 sc0 ls0 ws0">2<span class="_ _7a"> </span><span class="ff5 fs4">lw<span class="_ _7a"> </span>t1,<span class="_ _4"> </span>0(sp)<span class="_ _3f"> </span>#<span class="_ _18"> </span>load<span class="_ _4"> </span>the<span class="_ _4"> </span>9th<span class="_ _4"> </span>parameter<span class="_ _18"> </span>into<span class="_ _4"> </span>t1</span></div><div class="t m0 x114 h9 yffd ff22 fs11 fc0 sc0 ls0 ws0">3<span class="_ _7a"> </span><span class="ff5 fs4">lw<span class="_ _7a"> </span>t2,<span class="_ _4"> </span>4(sp)<span class="_ _3f"> </span>#<span class="_ _18"> </span>load<span class="_ _4"> </span>the<span class="_ _4"> </span>10th<span class="_ _4"> </span>parameter<span class="_ _18"> </span>into<span class="_ _4"> </span>t2</span></div><div class="t m0 x114 h9 yffe ff22 fs11 fc0 sc0 ls0 ws0">4<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a1<span class="_ _7a"> </span>#<span class="_ _18"> </span>sum<span class="_ _4"> </span>all<span class="_ _18"> </span>parameters</span></div><div class="t m0 x114 h9 yfff ff22 fs11 fc0 sc0 ls0 ws0">5<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a2</span></div><div class="t m0 x114 h9 y1000 ff22 fs11 fc0 sc0 ls0 ws0">6<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a3</span></div><div class="t m0 x114 h9 y1001 ff22 fs11 fc0 sc0 ls0 ws0">7<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a4</span></div><div class="t m0 x114 h9 y1002 ff22 fs11 fc0 sc0 ls0 ws0">8<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a5</span></div><div class="t m0 x114 h9 y1003 ff22 fs11 fc0 sc0 ls0 ws0">9<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a6</span></div><div class="t m0 x126 h9 y1004 ff22 fs11 fc0 sc0 ls0 ws0">10<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a7</span></div><div class="t m0 x126 h9 y1005 ff22 fs11 fc0 sc0 ls0 ws0">11<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>t1</span></div><div class="t m0 x126 h9 y1006 ff22 fs11 fc0 sc0 ls0 ws0">12<span class="_ _7a"> </span><span class="ff5 fs4">add<span class="_ _4"> </span>a0,<span class="_ _4"> </span>a0,<span class="_ _4"> </span>t2<span class="_ _7a"> </span>#<span class="_ _18"> </span>place<span class="_ _4"> </span>return<span class="_ _18"> </span>value<span class="_ _4"> </span>on<span class="_ _4"> </span>a0</span></div><div class="t m0 x126 h9 y1007 ff22 fs11 fc0 sc0 ls0 ws0">13<span class="_ _7a"> </span><span class="ff5 fs4">ret<span class="_ _94"> </span>#<span class="_ _4"> </span>return</span></div><div class="t m0 xf hb y1008 ff6 fs6 fc0 sc0 ls0 ws0">7.4.2<span class="_ _11"> </span>Returning<span class="_ _7"> </span>v<span class="_ _9"></span>alues<span class="_ _7"> </span>from<span class="_ _24"> </span>routines</div><div class="t m0 xf h8 y1009 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _3"> </span>RISC-V<span class="_ _3"> </span><span class="ff5">ilp32<span class="_ _b"> </span></span>ABI<span class="_ _3"> </span>deﬁnes<span class="_ _b"> </span>that<span class="_ _3"> </span>v<span class="_ _27"></span>alues<span class="_ _3"> </span>should<span class="_ _b"> </span>b<span class="_ _5"></span>e<span class="_ _3"> </span>returned<span class="_ _b"> </span>in<span class="_ _3"> </span>register<span class="_ _3"> </span><span class="ff5">a0</span>.<span class="_ _2a"> </span>In<span class="_ _b"> </span>case<span class="_ _3"> </span>the<span class="_ _b"> </span>v<span class="_ _9"></span>alue<span class="_ _b"> </span>b<span class="_ _5"></span>eing</div><div class="t m0 xf h8 y100a ff3 fs4 fc0 sc0 ls0 ws0">returned<span class="_ _3"> </span>is<span class="_ _3"> </span>64-bit<span class="_ _b"> </span>long,<span class="_ _3"> </span>then<span class="_ _b"> </span>the<span class="_ _3"> </span>least<span class="_ _3"> </span>signiﬁcant<span class="_ _3"> </span>32<span class="_ _3"> </span>bits<span class="_ _b"> </span>m<span class="_ _27"></span>ust<span class="_ _b"> </span>b<span class="_ _5"></span>e<span class="_ _3"> </span>returned<span class="_ _3"> </span>in<span class="_ _b"> </span>register<span class="_ _3"> </span><span class="ff5">a0<span class="_ _3"> </span></span>and<span class="_ _b"> </span>the<span class="_ _3"> </span>most</div><div class="t m0 xf h8 y100b ff3 fs4 fc0 sc0 ls0 ws0">signiﬁcan<span class="_ _1"></span>t<span class="_ _2"> </span>32<span class="_ _2"> </span>bits<span class="_ _6"> </span>must<span class="_ _6"> </span>b<span class="_ _5"></span>e<span class="_ _2"> </span>returned<span class="_ _2"> </span>in<span class="_ _2"> </span>register<span class="_ _2"> </span><span class="ff5">a1</span>.</div><div class="t m0 xf he y100c ff6 fs3 fc0 sc0 ls0 ws0">7.5<span class="_ _37"> </span>V<span class="_ _12"></span>alue<span class="_ _18"> </span>and<span class="_ _4"> </span>reference<span class="_ _2a"> </span>parameters</div><div class="t m0 xf h8 y100d ff3 fs4 fc0 sc0 ls0 ws0">P<span class="_ _1"></span>arameters may b<span class="_ _5"></span>e<span class="_ _6"> </span>passed<span class="_ _6"> </span>as v<span class="_ _27"></span>alues<span class="_ _6"> </span>or<span class="_ _6"> </span>as<span class="_ _6"> </span>references to<span class="_ _6"> </span>v<span class="_ _27"></span>ariables.<span class="_ _7"> </span><span class="ff7">V<span class="_ _12"></span>alue<span class="_ _3"> </span>parameters<span class="_ _2"> </span>are<span class="_ _3"> </span>parameters</span></div><div class="t m0 xf h8 y100e ff7 fs4 fc0 sc0 ls0 ws0">that<span class="_ _2"> </span>contain the<span class="_ _3"> </span>v<span class="_ _27"></span>alue<span class="_ _3"> </span>itself<span class="ff3">,<span class="_ _6"> </span><span class="ff8">i.e.</span>,<span class="_ _6"> </span>the<span class="_ _6"> </span>v<span class="_ _27"></span>alue<span class="_ _6"> </span>is<span class="_ _6"> </span>placed<span class="_ _6"> </span>directly<span class="_ _6"> </span>into the<span class="_ _6"> </span>registers<span class="_ _6"> </span>or<span class="_ _6"> </span>the<span class="_ _6"> </span>program<span class="_ _6"> </span>stack.</span></div><div class="t m0 x2c h8 y33 ff3 fs4 fc0 sc0 ls0 ws0">Prin<span class="_ _1"></span>ted<span class="_ _2"> </span>v<span class="_ _1"></span>ersion<span class="_ _2"> </span>a<span class="_ _1"></span>v<span class="_ _27"></span>ailable<span class="_ _2"> </span>for<span class="_ _6"> </span>purchase<span class="_ _6"> </span>at<span class="_ _2"> </span>Amazon.com</div><div class="t m0 x2d h8 y141 ff3 fs4 fc0 sc0 ls0 ws0">F<span class="_ _9"></span>ree<span class="_ _2"> </span>online<span class="_ _6"> </span>version<span class="_ _6"> </span>at<span class="_ _2"> </span><span class="ff5">http://riscv-<span class="_ _22"></span>programming.org</span></div><div class="t m0 x2e h8 y142 ff3 fs4 fc0 sc0 ls0 ws0">(Generated<span class="_ _2"> </span>on<span class="_ _2"> </span>Octob<span class="_ _5"></span>er<span class="_ _6"> </span>15,<span class="_ _2"> </span>2023)</div><div class="t m0 xb8 h8 y33 ff3 fs4 fc0 sc0 ls0 ws0">96</div><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",72,598.394,null]'><div class="d m1" style="border-style:none;position:absolute;left:212.724000px;bottom:469.558000px;width:20.119000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pfa" data-dest-detail='[10,"XYZ",72,598.394,null]'><div class="d m1" style="border-style:none;position:absolute;left:159.953000px;bottom:197.170000px;width:20.119000px;height:11.125000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://a.co/d/gUfKWsD"><div class="d m1" style="border-style:none;position:absolute;left:358.258000px;bottom:69.067000px;width:58.171000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:271.722000px;bottom:56.835000px;width:148.940000px;height:11.125000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
