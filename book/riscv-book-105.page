<div id="pf69" class="pf w0 h0" data-page-no="69"><div class="pc pc69 w0 h0"><img class="bi xf yf9f w1d hc0" alt="" src="bg69.png"/><div class="t m0 xf hd yed ff6 fs8 fc0 sc0 ls0 ws0">Chapter<span class="_ _1f"> </span>7</div><div class="t m0 xf ha yee ff6 fs5 fc0 sc0 ls0 ws0">Implemen<span class="_ _9"></span>ting<span class="_ _14"> </span>routines</div><div class="t m0 xf he yfa0 ff6 fs3 fc0 sc0 ls0 ws0">7.1<span class="_ _37"> </span>The<span class="_ _4"> </span>program<span class="_ _4"> </span>memory<span class="_ _4"> </span>lay<span class="_ _9"></span>out</div><div class="t m0 xf h8 yfa1 ff3 fs4 fc0 sc0 ls0 ws0">A <span class="ff7">stored-program </span>computer arc<span class="_ _27"></span>hitecture<span class="_ _38"> </span>is<span class="_ _6"> </span>a computer<span class="_ _38"> </span>architecture that stores<span class="_ _38"> </span>b<span class="_ _5"></span>oth<span class="_ _6"> </span>data and co<span class="_ _5"></span>de<span class="_ _6"> </span>on</div><div class="t m0 xf h8 yfa2 ff3 fs4 fc0 sc0 ls0 ws0">memory<span class="_ _9"></span>.<span class="_ _34"> </span>A<span class="_ _6"> </span><span class="ff7">V<span class="_ _12"></span>on<span class="_ _3"> </span>Neumann<span class="_ _2"> </span>architecture<span class="_ _38"> </span><span class="ff3">is<span class="_ _6"> </span>a computer<span class="_ _6"> </span>architecture that<span class="_ _6"> </span>stores<span class="_ _6"> </span>b<span class="_ _5"></span>oth the<span class="_ _6"> </span>data<span class="_ _6"> </span>and<span class="_ _6"> </span>the</span></span></div><div class="t m0 xf h8 yfa3 ff3 fs4 fc0 sc0 ls0 ws0">co<span class="_ _5"></span>de<span class="_ _6"> </span>at<span class="_ _2"> </span>the<span class="_ _2"> </span>same<span class="_ _2"> </span>address<span class="_ _2"> </span>space.<span class="_ _7"> </span>Most<span class="_ _2"> </span>mo<span class="_ _5"></span>dern<span class="_ _2"> </span>computer<span class="_ _2"> </span>architectures<span class="_ _6"> </span>are<span class="_ _2"> </span>V<span class="_ _9"></span>on<span class="_ _2"> </span>Neumann<span class="_ _2"> </span>architectures.</div><div class="t m0 xc h8 yfa4 ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _35"> </span>7.1<span class="_ _a"> </span>shows<span class="_ _35"> </span>a<span class="_ _35"> </span>common<span class="_ _a"> </span>wa<span class="_ _27"></span>y<span class="_ _a"> </span>of<span class="_ _a"> </span>organizing<span class="_ _35"> </span>programs<span class="_ _a"> </span>on<span class="_ _a"> </span>the<span class="_ _35"> </span>memory<span class="_ _a"> </span>of<span class="_ _a"> </span>V<span class="_ _9"></span>on<span class="_ _a"> </span>Neumann<span class="_ _35"> </span>architectures.</div><div class="t m0 xf h8 yfa5 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _b"> </span><span class="ff7">co<span class="_ _5"></span>de<span class="_ _24"> </span>space<span class="_ _24"> </span>is<span class="_ _24"> </span>a<span class="_ _24"> </span>memory<span class="_ _7"> </span>space<span class="_ _24"> </span>that<span class="_ _24"> </span>stores<span class="_ _24"> </span>the<span class="_ _24"> </span>program<span class="_ _24"> </span>co<span class="_ _5"></span>de<span class="_ _b"> </span></span>and<span class="_ _34"> </span>is<span class="_ _b"> </span>usually<span class="_ _34"> </span>placed<span class="_ _34"> </span>ﬁrst,</div><div class="t m0 xf h8 yfa6 ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _7"> </span>the<span class="_ _7"> </span>low<span class="_ _27"></span>est<span class="_ _7"> </span>addresses.<span class="_ _1f"> </span>The<span class="_ _7"> </span><span class="ff7">static<span class="_ _4"> </span>data<span class="_ _18"> </span>space<span class="_ _18"> </span>is<span class="_ _4"> </span>a<span class="_ _18"> </span>memory<span class="_ _4"> </span>space<span class="_ _18"> </span>that<span class="_ _18"> </span>stores<span class="_ _4"> </span>the<span class="_ _18"> </span>program</span></div><div class="t m0 xf h8 yfa7 ff7 fs4 fc0 sc0 ls0 ws0">static<span class="_ _3"> </span>data <span class="ff3">(<span class="ff8">e.g.</span>,<span class="_ _38"> </span>global<span class="_ _2"> </span>v<span class="_ _27"></span>ariables)<span class="_ _6"> </span>and<span class="_ _6"> </span>is<span class="_ _6"> </span>placed<span class="_ _6"> </span>after<span class="_ _6"> </span>the<span class="_ _2"> </span>co<span class="_ _5"></span>de.<span class="_ _34"> </span>The<span class="_ _6"> </span><span class="ff7">heap<span class="_ _3"> </span>space<span class="_ _3"> </span>is<span class="_ _3"> </span>a<span class="_ _3"> </span>memory<span class="_ _3"> </span>space</span></span></div><div class="t m0 xf h8 ya06 ff7 fs4 fc0 sc0 ls0 ws0">managed by the memory<span class="_ _2"> </span>allo<span class="_ _22"></span>cation library</div><div class="t m0 x66 h12 yfa8 ffc fs7 fc0 sc0 ls0 ws0">1</div><div class="t m0 x15 h8 ya06 ff3 fs4 fc0 sc0 ls0 ws0">and is<span class="_ _6"> </span>allo<span class="_ _5"></span>cated after<span class="_ _38"> </span>the<span class="_ _6"> </span>static data.<span class="_ _7"> </span>The<span class="_ _38"> </span>heap<span class="_ _6"> </span>starts</div><div class="t m0 xf h8 ya07 ff3 fs4 fc0 sc0 ls0 ws0">small<span class="_ _b"> </span>and,<span class="_ _b"> </span>whenever<span class="_ _3"> </span>the<span class="_ _b"> </span>memory<span class="_ _3"> </span>allo<span class="_ _5"></span>cation<span class="_ _b"> </span>library<span class="_ _b"> </span>needs<span class="_ _b"> </span>more<span class="_ _b"> </span>space,<span class="_ _b"> </span>it<span class="_ _b"> </span>inv<span class="_ _27"></span>okes<span class="_ _3"> </span>the<span class="_ _b"> </span>op<span class="_ _5"></span>erating<span class="_ _b"> </span>system</div><div class="t m0 xf h8 yfa9 ff3 fs4 fc0 sc0 ls0 ws0">to<span class="_ _b"> </span>gro<span class="_ _1"></span>w<span class="_ _b"> </span>the<span class="_ _b"> </span>heap<span class="_ _b"> </span>area,<span class="_ _34"> </span>which<span class="_ _3"> </span>do<span class="_ _5"></span>es<span class="_ _b"> </span>it<span class="_ _b"> </span>by<span class="_ _3"> </span>increasing<span class="_ _b"> </span>the<span class="_ _34"> </span>“program<span class="_ _b"> </span>break”<span class="_ _b"> </span>address</div><div class="t m0 x4a h12 ya09 ffc fs7 fc0 sc0 ls0 ws0">2</div><div class="t m0 x16 h8 yfa9 ff3 fs4 fc0 sc0 ls0 ws0">.<span class="_ _17"> </span>Finally<span class="_ _9"></span>,<span class="_ _b"> </span>the<span class="_ _34"> </span><span class="ff7">stac<span class="_ _1"></span>k</span></div><div class="t m0 xf h8 yfaa ff7 fs4 fc0 sc0 ls0 ws0">space<span class="_ _34"> </span>is<span class="_ _34"> </span>a<span class="_ _34"> </span>memory<span class="_ _7"> </span>space<span class="_ _34"> </span>that<span class="_ _34"> </span>stores<span class="_ _34"> </span>the<span class="_ _7"> </span>program<span class="_ _34"> </span>stack<span class="_ _2"> </span><span class="ff3">and<span class="_ _3"> </span>is<span class="_ _b"> </span>usually<span class="_ _3"> </span>placed<span class="_ _3"> </span>at<span class="_ _3"> </span>the<span class="_ _b"> </span>end<span class="_ _3"> </span>(high</span></div><div class="t m0 xf h8 yfab ff3 fs4 fc0 sc0 ls0 ws0">addresses)<span class="_ _2"> </span>of<span class="_ _2"> </span>the<span class="_ _6"> </span>memory<span class="_ _27"></span>.</div><div class="c xb7 yfac w1e hc1"><div class="t m0 x12e hc2 yfad ff8d fs3e fc0 sc0 ls0 ws0">0x0000</div><div class="t m2 x110 hc3 yfae ff8e fs3f fc0 sc0 ls0 ws0">Addresses</div><div class="t m0 x131 hc3 yfaf ff8e fs3f fc0 sc0 ls0 ws0">Code</div><div class="t m0 x139 hc3 yfb0 ff8e fs3f fc0 sc0 ls0 ws0">Static Data</div><div class="t m0 x131 hc3 yfb1 ff8e fs3f fc0 sc0 ls0 ws0">Stack</div><div class="t m0 x133 hc3 yfb2 ff8e fs3f fc0 sc0 ls0 ws0">Main Memory</div><div class="t m0 xbf hc3 yfb3 ff8e fs3f fc0 sc0 ls0 ws0">T<span class="_ _9"></span>op of </div><div class="t m0 xbf hc3 yfb4 ff8e fs3f fc0 sc0 ls0 ws0">the stack</div><div class="t m0 x131 hc3 yfb5 ff8e fs3f fc0 sc0 ls0 ws0">Heap</div><div class="t m0 xbf hc3 yfb6 ff8e fs3f fc0 sc0 ls0 ws0">Program </div><div class="t m0 xbf hc3 yfb7 ff8e fs3f fc0 sc0 ls0 ws0">break</div><div class="t m0 xf3 hc3 yfb8 ff8e fs3f fc0 sc0 ls0 ws0">Free space</div></div><div class="t m0 x9e h8 yfb9 ff3 fs4 fc0 sc0 ls0 ws0">Figure<span class="_ _2"> </span>7.1:<span class="_ _7"> </span>Common<span class="_ _2"> </span>program<span class="_ _6"> </span>mem<span class="_ _5"></span>ory<span class="_ _6"> </span>lay<span class="_ _27"></span>out.</div><div class="t m0 x2b h1e yfba fff fsd fc0 sc0 ls0 ws0">1</div><div class="t m0 xc h1f yfbb ff10 fse fc0 sc0 ls0 ws0">The memory allo<span class="_ _5"></span>cation<span class="_ _8b"> </span>library allows the program<span class="_ _8b"> </span>to dynamically<span class="_ _8b"> </span>allo<span class="_ _5"></span>cate (and free)<span class="_ _8b"> </span>data on<span class="_ _8b"> </span>the heap.<span class="_ _b"> </span>Data allo<span class="_ _5"></span>cated</div><div class="t m0 xf h1f yfbc ff10 fse fc0 sc0 ls0 ws0">using<span class="_ _8b"> </span>the<span class="_ _8b"> </span><span class="ff28">malloc<span class="_ _38"> </span></span>routine,<span class="_ _8b"> </span>for<span class="_ _38"> </span>example,<span class="_ _8b"> </span>is<span class="_ _38"> </span>allo<span class="_ _5"></span>cated<span class="_ _8b"> </span>into the<span class="_ _8b"> </span>heap.<span class="_ _b"> </span>The<span class="_ _8b"> </span>memory<span class="_ _8b"> </span>allo<span class="_ _5"></span>cation<span class="_ _38"> </span>library<span class="_ _8b"> </span>is<span class="_ _8b"> </span>resp<span class="_ _5"></span>onsible<span class="_ _38"> </span>for<span class="_ _8b"> </span>keeping</div><div class="t m0 xf h1f yfbd ff10 fse fc0 sc0 ls0 ws0">track of<span class="_ _38"> </span>which<span class="_ _38"> </span>addresses<span class="_ _38"> </span>within<span class="_ _38"> </span>the<span class="_ _38"> </span>heap<span class="_ _38"> </span>are<span class="_ _38"> </span>free<span class="_ _38"> </span>or<span class="_ _38"> </span>allo<span class="_ _5"></span>cated.</div><div class="t m0 x2b h1e yfbe fff fsd fc0 sc0 ls0 ws0">2</div><div class="t m0 xc h1f yfbf ff10 fse fc0 sc0 ls0 ws0">The<span class="_ _38"> </span>program<span class="_ _38"> </span>break<span class="_ _38"> </span>deﬁnes<span class="_ _38"> </span>the<span class="_ _38"> </span>end<span class="_ _38"> </span>of<span class="_ _38"> </span>the<span class="_ _38"> </span>heap.</div><div class="t m0 x14 h8 y33 ff3 fs4 fc0 sc0 ls0 ws0">92</div><a class="l" href="#pf69" data-dest-detail='[105,"XYZ",72,378.953,null]'><div class="d m1" style="border-style:none;position:absolute;left:116.291000px;bottom:480.129000px;width:14.723000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf69" data-dest-detail='[105,"XYZ",87.243,191.203,null]'><div class="d m1" style="border-style:none;position:absolute;left:283.323000px;bottom:432.308000px;width:6.462000px;height:12.040000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf69" data-dest-detail='[105,"XYZ",87.243,162.77,null]'><div class="d m1" style="border-style:none;position:absolute;left:428.966000px;bottom:408.398000px;width:6.462000px;height:12.039000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
