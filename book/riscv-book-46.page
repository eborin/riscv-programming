<div id="pf2e" class="pf w0 h0" data-page-no="2e"><div class="pc pc2e w0 h0"><img class="bi xf y50d w2 h4c" alt="" src="bg2e.png"/><div class="t m0 xf h8 y10d ff3 fs4 fc0 sc0 ls0 ws0">3.2.<span class="_ _1f"> </span>LABELS,<span class="_ _2"> </span>SYMBOLS,<span class="_ _2"> </span>REFERENCES,<span class="_ _2"> </span>AND<span class="_ _2"> </span>RELOCA<span class="_ _9"></span>TION</div><div class="t m0 xf h9 y57 ff5 fs4 fc0 sc0 ls0 ws0">$<span class="_ _18"> </span>riscv64-unknown-elf-objdump<span class="_ _4"> </span>-r<span class="_ _4"> </span>trunk.o</div><div class="t m0 xf h9 y87 ff5 fs4 fc0 sc0 ls0 ws0">trunk.o:<span class="_ _8c"> </span>file<span class="_ _18"> </span>format<span class="_ _4"> </span>elf32-littleriscv</div><div class="t m0 xf h9 y89 ff5 fs4 fc0 sc0 ls0 ws0">RELOCATION<span class="_ _18"> </span>RECORDS<span class="_ _4"> </span>FOR<span class="_ _4"> </span>[.text]:</div><div class="t m0 xf h9 y8a ff5 fs4 fc0 sc0 ls0 ws0">OFFSET<span class="_ _3f"> </span>TYPE<span class="_ _50"> </span>VALUE</div><div class="t m0 xf h9 y8b ff5 fs4 fc0 sc0 ls0 ws0">00000004<span class="_ _18"> </span>R_RISCV_BRANCH<span class="_ _85"> </span>done</div><div class="t m0 xc h8 y7f1 ff3 fs4 fc0 sc0 ls0 ws0">The<span class="_ _7"> </span>follo<span class="_ _1"></span>wing<span class="_ _7"> </span>example<span class="_ _7"> </span>sho<span class="_ _1"></span>ws<span class="_ _7"> </span>what<span class="_ _34"> </span>happ<span class="_ _5"></span>ens<span class="_ _7"> </span>to<span class="_ _7"> </span>the<span class="_ _7"> </span>previous<span class="_ _7"> </span>program<span class="_ _7"> </span>once<span class="_ _7"> </span>it<span class="_ _7"> </span>is<span class="_ _7"> </span>linked.<span class="_ _1f"> </span>First,<span class="_ _24"> </span>w<span class="_ _1"></span>e</div><div class="t m0 xf h8 y7f2 ff3 fs4 fc0 sc0 ls0 ws0">pro<span class="_ _5"></span>duce<span class="_ _3"> </span>the<span class="_ _b"> </span><span class="ff5">trunk.x<span class="_ _3"> </span></span>ﬁle<span class="_ _b"> </span>by<span class="_ _2"> </span>inv<span class="_ _27"></span>oking<span class="_ _b"> </span>the<span class="_ _3"> </span>linker.<span class="_ _2a"> </span>Then,<span class="_ _b"> </span>we<span class="_ _2"> </span>insp<span class="_ _5"></span>ect<span class="_ _b"> </span>the<span class="_ _3"> </span>conten<span class="_ _27"></span>ts<span class="_ _b"> </span>of<span class="_ _b"> </span>the<span class="_ _3"> </span><span class="ff5">trunk.x<span class="_ _b"> </span></span>ﬁle<span class="_ _3"> </span>by</div><div class="t m0 xf h8 y7f3 ff3 fs4 fc0 sc0 ls0 ws0">using<span class="_ _2"> </span>the<span class="_ _2"> </span><span class="ff5">riscv64-unknown-elf-objdump<span class="_ _6"> </span></span>to<span class="_ _5"></span>ol.</div><div class="t m0 xf h9 y7f4 ff5 fs4 fc0 sc0 ls0 ws0">$<span class="_ _18"> </span>riscv64-unknown-elf-ld<span class="_ _4"> </span>-m<span class="_ _4"> </span>elf32lriscv<span class="_ _4"> </span>trunk.o<span class="_ _4"> </span>-o<span class="_ _18"> </span>trunk.x</div><div class="t m0 xf h9 y7f5 ff5 fs4 fc0 sc0 ls0 ws0">$<span class="_ _18"> </span>riscv64-unknown-elf-objdump<span class="_ _4"> </span>-D<span class="_ _4"> </span>trunk.x</div><div class="t m0 xf h9 y7f6 ff5 fs4 fc0 sc0 ls0 ws0">trunk.x:<span class="_ _8c"> </span>file<span class="_ _18"> </span>format<span class="_ _4"> </span>elf32-littleriscv</div><div class="t m0 xf h9 y7f7 ff5 fs4 fc0 sc0 ls0 ws0">Disassembly<span class="_ _18"> </span>of<span class="_ _4"> </span>section<span class="_ _4"> </span>.text:</div><div class="t m0 xf h9 y7f8 ff5 fs4 fc0 sc0 ls0 ws0">00010054<span class="_ _18"> </span>&lt;trunk42&gt;:</div><div class="t m0 xc h9 y7f9 ff5 fs4 fc0 sc0 ls0 ws0">10054:<span class="_ _7a"> </span>02a00313<span class="_ _3d"> </span>li<span class="_ _4"> </span>t1,42</div><div class="t m0 xc h9 y7fa ff5 fs4 fc0 sc0 ls0 ws0">10058:<span class="_ _7a"> </span>00a35463<span class="_ _3d"> </span>bge<span class="_ _4"> </span>t1,a0,10060<span class="_ _4"> </span>&lt;done&gt;</div><div class="t m0 xc h9 y7fb ff5 fs4 fc0 sc0 ls0 ws0">1005c:<span class="_ _7a"> </span>00030513<span class="_ _3d"> </span>mv<span class="_ _4"> </span>a0,t1</div><div class="t m0 xf h9 y7fc ff5 fs4 fc0 sc0 ls0 ws0">00010060<span class="_ _18"> </span>&lt;done&gt;:</div><div class="t m0 xc h9 y7fd ff5 fs4 fc0 sc0 ls0 ws0">10060:<span class="_ _7a"> </span>00008067<span class="_ _3d"> </span>ret</div><div class="t m0 xc h9 y7fe ff5 fs4 fc0 sc0 ls0 ws0">...</div><div class="t m0 xc h8 y7ff ff3 fs4 fc0 sc0 ls0 ws0">Notice<span class="_ _b"> </span>that<span class="_ _b"> </span>the<span class="_ _b"> </span>co<span class="_ _5"></span>de<span class="_ _b"> </span>on<span class="_ _34"> </span>the<span class="_ _b"> </span><span class="ff5">trunk.x<span class="_ _b"> </span></span>program<span class="_ _34"> </span>w<span class="_ _1"></span>as<span class="_ _b"> </span>relo<span class="_ _5"></span>cated,<span class="_ _34"> </span><span class="ff8">i.e.</span>,<span class="_ _34"> </span>assigned<span class="_ _b"> </span>new<span class="_ _b"> </span>addresses.<span class="_ _d"> </span>In<span class="_ _b"> </span>this</div><div class="t m0 xf h8 y800 ff3 fs4 fc0 sc0 ls0 ws0">example,<span class="_ _7"> </span>the<span class="_ _7"> </span>co<span class="_ _5"></span>de<span class="_ _7"> </span>of<span class="_ _7"> </span>the<span class="_ _34"> </span><span class="ff5">trunk42<span class="_ _7"> </span></span>routine<span class="_ _7"> </span>starts<span class="_ _7"> </span>at<span class="_ _7"> </span>address<span class="_ _34"> </span><span class="ff5">10054<span class="_ _7"> </span></span>and<span class="_ _7"> </span>the<span class="_ _7"> </span><span class="ff5">bge<span class="_ _7"> </span></span>instruction<span class="_ _34"> </span>jumps<span class="_ _7"> </span>to</div><div class="t m0 xf h8 y801 ff3 fs4 fc0 sc0 ls0 ws0">address<span class="_ _2"> </span><span class="ff5">10060<span class="_ _2"> </span></span>in<span class="_ _6"> </span>case<span class="_ _2"> </span>the<span class="_ _2"> </span>v<span class="_ _27"></span>alue<span class="_ _2"> </span>in<span class="_ _2"> </span>register<span class="_ _2"> </span><span class="ff5">t1<span class="_ _2"> </span></span>is<span class="_ _2"> </span>greater<span class="_ _2"> </span>or<span class="_ _2"> </span>equal<span class="_ _2"> </span>to<span class="_ _2"> </span>the<span class="_ _2"> </span>v<span class="_ _27"></span>alue<span class="_ _2"> </span>in<span class="_ _2"> </span>register<span class="_ _2"> </span><span class="ff5">a0</span>.</div><div class="t m0 xf hb y802 ff6 fs6 fc0 sc0 ls0 ws0">3.2.3<span class="_ _11"> </span>Undeﬁned<span class="_ _7"> </span>references</div><div class="t m0 xf h8 y803 ff3 fs4 fc0 sc0 ls0 ws0">As<span class="_ _2"> </span>discussed<span class="_ _3"> </span>in<span class="_ _2"> </span>previous<span class="_ _2"> </span>sections,<span class="_ _3"> </span>assembly<span class="_ _6"> </span>co<span class="_ _5"></span>de<span class="_ _3"> </span>relies<span class="_ _2"> </span>on<span class="_ _3"> </span>lab<span class="_ _5"></span>els<span class="_ _2"> </span>to<span class="_ _2"> </span>refer<span class="_ _3"> </span>to<span class="_ _2"> </span>program<span class="_ _3"> </span>lo<span class="_ _5"></span>cations.<span class="_ _24"> </span>In<span class="_ _3"> </span>some</div><div class="t m0 xf h8 y804 ff3 fs4 fc0 sc0 ls0 ws0">cases,<span class="_ _2"> </span>an<span class="_ _3"> </span>assem<span class="_ _1"></span>bly<span class="_ _2"> </span>co<span class="_ _5"></span>de<span class="_ _2"> </span>may<span class="_ _2"> </span>refer<span class="_ _2"> </span>to<span class="_ _3"> </span>a<span class="_ _2"> </span>lab<span class="_ _5"></span>el<span class="_ _2"> </span>that<span class="_ _3"> </span>is<span class="_ _2"> </span>not<span class="_ _3"> </span>deﬁned<span class="_ _2"> </span>in<span class="_ _3"> </span>the<span class="_ _2"> </span>same<span class="_ _2"> </span>ﬁle.<span class="_ _18"> </span>This<span class="_ _2"> </span>is<span class="_ _3"> </span>common<span class="_ _2"> </span>when</div><div class="t m0 xf h8 y805 ff3 fs4 fc0 sc0 ls0 ws0">in<span class="_ _1"></span>v<span class="_ _1"></span>oking a<span class="_ _a"> </span>routine that is implemen<span class="_ _27"></span>ted on another<span class="_ _a"> </span>ﬁle or when<span class="_ _a"> </span>accessing a global<span class="_ _a"> </span>v<span class="_ _27"></span>ariable that is<span class="_ _a"> </span>declared</div><div class="t m0 xf h8 y806 ff3 fs4 fc0 sc0 ls0 ws0">on<span class="_ _6"> </span>another<span class="_ _2"> </span>ﬁle.<span class="_ _7"> </span>The<span class="_ _6"> </span>following<span class="_ _6"> </span>example<span class="_ _6"> </span>shows<span class="_ _6"> </span>an<span class="_ _2"> </span>assembly co<span class="_ _5"></span>de<span class="_ _2"> </span>that<span class="_ _2"> </span>refers<span class="_ _6"> </span>to<span class="_ _2"> </span>a<span class="_ _6"> </span>lab<span class="_ _5"></span>el<span class="_ _2"> </span>that<span class="_ _2"> </span>is<span class="_ _6"> </span>not<span class="_ _2"> </span>deﬁned</div><div class="t m0 xf h8 y807 ff3 fs4 fc0 sc0 ls0 ws0">on<span class="_ _b"> </span>the<span class="_ _3"> </span>same<span class="_ _b"> </span>ﬁle,<span class="_ _b"> </span>called<span class="_ _b"> </span><span class="ff5">main.s</span>.<span class="_ _17"> </span>The<span class="_ _b"> </span><span class="ff5">exit<span class="_ _3"> </span></span>lab<span class="_ _5"></span>el<span class="_ _b"> </span>is<span class="_ _b"> </span>used<span class="_ _b"> </span>on<span class="_ _b"> </span>instruction<span class="_ _3"> </span><span class="ff5">jal<span class="_ _b"> </span></span>(line<span class="_ _b"> </span>5),<span class="_ _b"> </span>how<span class="_ _27"></span>ever,<span class="_ _b"> </span>it<span class="_ _b"> </span>is<span class="_ _3"> </span>not</div><div class="t m0 xf h8 y808 ff3 fs4 fc0 sc0 ls0 ws0">deﬁned<span class="_ _2"> </span>in<span class="_ _2"> </span>this<span class="_ _6"> </span>ﬁle</div><div class="t m0 x7a h12 y809 ffc fs7 fc0 sc0 ls0 ws0">10</div><div class="t m0 xb3 h8 y808 ff3 fs4 fc0 sc0 ls0 ws0">.</div><div class="t m0 x114 h9 y80a ff22 fs11 fc0 sc0 ls0 ws0">1<span class="_ _2a"> </span><span class="ff5 fs4">#<span class="_ _4"> </span>Contents<span class="_ _18"> </span>of<span class="_ _4"> </span>the<span class="_ _4"> </span>main.s<span class="_ _4"> </span>file</span></div><div class="t m0 x114 h9 y80b ff22 fs11 fc0 sc0 ls0 ws0">2<span class="_ _2a"> </span><span class="ff5 fs4">start:</span></div><div class="t m0 x114 h9 y80c ff22 fs11 fc0 sc0 ls0 ws0">3<span class="_ _37"> </span><span class="ff5 fs4">li<span class="_ _7a"> </span>a0,<span class="_ _18"> </span>10</span></div><div class="t m0 x114 h9 y80d ff22 fs11 fc0 sc0 ls0 ws0">4<span class="_ _37"> </span><span class="ff5 fs4">li<span class="_ _7a"> </span>a1,<span class="_ _18"> </span>20</span></div><div class="t m0 x114 h9 y80e ff22 fs11 fc0 sc0 ls0 ws0">5<span class="_ _37"> </span><span class="ff5 fs4">jal<span class="_ _18"> </span>exit</span></div><div class="t m0 xc h8 y80f ff3 fs4 fc0 sc0 ls0 ws0">The assem<span class="_ _27"></span>bler assem<span class="_ _27"></span>bles this<span class="_ _a"> </span>program and<span class="_ _a"> </span>register the<span class="_ _a"> </span><span class="ff5">exit<span class="_ _8b"> </span></span>lab<span class="_ _5"></span>el on<span class="_ _a"> </span>the sym<span class="_ _27"></span>b<span class="_ _5"></span>ol table<span class="_ _a"> </span>as an<span class="_ _a"> </span>undeﬁned</div><div class="t m0 xf h8 y810 ff3 fs4 fc0 sc0 ls0 ws0">sym<span class="_ _1"></span>b<span class="_ _5"></span>ol.<span class="_ _b"> </span>The <span class="ff5">riscv64-unknown-elf-nm<span class="_ _a"> </span></span>to<span class="_ _5"></span>ol<span class="_ _a"> </span>identiﬁes<span class="_ _a"> </span>the<span class="_ _a"> </span>undeﬁned sym<span class="_ _27"></span>b<span class="_ _5"></span>ols<span class="_ _a"> </span>by<span class="_ _a"> </span>placing<span class="_ _a"> </span>the ‘U’<span class="_ _a"> </span>c<span class="_ _1"></span>haracter</div><div class="t m0 xf h8 y811 ff3 fs4 fc0 sc0 ls0 ws0">b<span class="_ _5"></span>efore<span class="_ _6"> </span>the<span class="_ _6"> </span>symbol<span class="_ _6"> </span>name.<span class="_ _7"> </span>Assuming<span class="_ _2"> </span>the<span class="_ _6"> </span>previous<span class="_ _6"> </span>co<span class="_ _5"></span>de<span class="_ _2"> </span>w<span class="_ _1"></span>as<span class="_ _6"> </span>assembled into<span class="_ _6"> </span>the<span class="_ _6"> </span><span class="ff5">main.o<span class="_ _6"> </span></span>ob<span class="_ _22"></span>ject<span class="_ _6"> </span>ﬁle,<span class="_ _2"> </span>w<span class="_ _1"></span>e<span class="_ _6"> </span>can</div><div class="t m0 xf h8 y812 ff3 fs4 fc0 sc0 ls0 ws0">insp<span class="_ _5"></span>ect<span class="_ _6"> </span>the<span class="_ _2"> </span>conten<span class="_ _27"></span>ts<span class="_ _2"> </span>of<span class="_ _2"> </span>its<span class="_ _2"> </span>symbol<span class="_ _2"> </span>table<span class="_ _2"> </span>as<span class="_ _2"> </span>follows:</div><div class="t m0 x40 h1e y813 fff fsd fc0 sc0 ls0 ws0">10</div><div class="t m0 xc h1f y44b ff10 fse fc0 sc0 ls0 ws0">The<span class="_ _6"> </span><span class="ff28">jal<span class="_ _6"> </span></span>instruction<span class="_ _2"> </span>is<span class="_ _6"> </span>used<span class="_ _6"> </span>to<span class="_ _2"> </span>inv<span class="_ _27"></span>oke<span class="_ _38"> </span>routines.<span class="_ _18"> </span>In<span class="_ _6"> </span>this<span class="_ _6"> </span>case,<span class="_ _2"> </span>it<span class="_ _6"> </span>is<span class="_ _2"> </span>inv<span class="_ _27"></span>oking<span class="_ _2"> </span>the<span class="_ _6"> </span><span class="ff28">exit<span class="_ _6"> </span></span>routine.<span class="_ _24"> </span>This<span class="_ _2"> </span>instruction<span class="_ _6"> </span>will<span class="_ _2"> </span>be</div><div class="t m0 xf h1f ye2 ff10 fse fc0 sc0 ls0 ws0">further<span class="_ _38"> </span>discussed<span class="_ _38"> </span>in<span class="_ _38"> </span>Section<span class="_ _38"> </span>5.7.3.</div><div class="t m0 x2c h8 y33 ff3 fs4 fc0 sc0 ls0 ws0">Prin<span class="_ _1"></span>ted<span class="_ _2"> </span>v<span class="_ _1"></span>ersion<span class="_ _2"> </span>a<span class="_ _1"></span>v<span class="_ _27"></span>ailable<span class="_ _2"> </span>for<span class="_ _6"> </span>purchase<span class="_ _6"> </span>at<span class="_ _2"> </span>Amazon.com</div><div class="t m0 x2d h8 y143 ff3 fs4 fc0 sc0 ls0 ws0">F<span class="_ _9"></span>ree<span class="_ _2"> </span>online<span class="_ _6"> </span>version<span class="_ _6"> </span>at<span class="_ _2"> </span><span class="ff5">http://riscv-<span class="_ _22"></span>programming.org</span></div><div class="t m0 x2e h8 y144 ff3 fs4 fc0 sc0 ls0 ws0">(Generated<span class="_ _2"> </span>on<span class="_ _2"> </span>August<span class="_ _6"> </span>28,<span class="_ _2"> </span>2024)</div><div class="t m0 xb8 h8 y33 ff3 fs4 fc0 sc0 ls0 ws0">33</div><a class="l" href="#pf2e" data-dest-detail='[46,"XYZ",87.243,120.817,null]'><div class="d m1" style="border-style:none;position:absolute;left:149.100000px;bottom:267.298000px;width:10.433000px;height:10.102000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="#pf5b" data-dest-detail='[91,"XYZ",72,555.792,null]'><div class="d m1" style="border-style:none;position:absolute;left:175.837000px;bottom:98.052000px;width:19.400000px;height:10.367000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="https://a.co/d/gUfKWsD"><div class="d m1" style="border-style:none;position:absolute;left:358.258000px;bottom:69.067000px;width:58.171000px;height:10.848000px;background-color:rgba(255,255,255,0.000001);"></div></a><a class="l" href="http://riscv-programming.org"><div class="d m1" style="border-style:none;position:absolute;left:271.722000px;bottom:56.835000px;width:148.940000px;height:11.125000px;background-color:rgba(255,255,255,0.000001);"></div></a></div><div class="pi" data-data='{"ctm":[1.000000,0.000000,0.000000,1.000000,0.000000,0.000000]}'></div></div>
